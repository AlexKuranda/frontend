function storeMapInit(e){return function(){var t=17,o=new ymaps.Map("map",{center:[55.753994,37.622093],zoom:16});o.controls.add(new ymaps.control.ZoomControl),o.behaviors.enable("scrollZoom");for(var s=new ymaps.GeoObjectCollection,i=[],a=0;a<e.length;a++)i[a]=new ymaps.Placemark([e[a].GPS_N,e[a].GPS_S],{storeIDByGPS:e[a].GPS_N+"__"+e[a].GPS_S,storeIDByXML:e[a].XML_ID,storeCity:e[a].CITY,storeAddress:e[a].ADDRESS,storeGPSCoords:[e[a].GPS_N,e[a].GPS_S]},{iconLayout:"default#image",iconImageHref:"/bitrix/templates/zoloto/frontend/images/sprites/sprite__primary-icon-set.png",iconImageSize:[33,44],iconImageClipRect:[[99,393],[132,437]]}),s.add(i[a]);o.geoObjects.add(s),o.geoObjects.events.add("click",function(e){var s=e.get("target"),i=(e.get("globalPixelPosition"),s.properties.get("storeIDByXML")),a=s.properties.get("storeGPSCoords");$(".store-item").removeClass("store-item--active"),$("#store-item-id"+i).addClass("store-item--active"),o.setCenter(a,t,{checkZoomRange:!0})}),$("#store-list-combobox").bind("change",function(){var e=$("#store-list-combobox option:selected"),t=e.attr("value");$(".store-item").removeClass("store-item--active"),ymaps.geocode(t,{results:1}).then(function(e){var t=e.geoObjects.get(0),s=(t.geometry.getCoordinates(),t.properties.get("boundedBy"));o.setBounds(s,{checkZoomRange:!0})})}),$("#store-list-combobox").trigger("change"),ymaps.geocode(storeCurrentCityName,{results:1}).then(function(e){var t=e.geoObjects.get(0),s=(t.geometry.getCoordinates(),t.properties.get("boundedBy"));o.setBounds(s,{checkZoomRange:!0})})}}$(document).on("click",".js-modal-close-button",function(){var e=$(this).closest(".js-modal-window");e&&e.removeClass(e.attr("data-js-modal-active-modifier"))});var storeCurrentCityName="",dataRawPath=Z585.HTMLRender.getDataRawByName("shops");$.when(Z585.HTMLRender.lazyGetTemplate("store-item-template"),Z585.HTMLRender.lazyGetTemplate("store-list-template"),Z585.HTMLRender.lazyGetTemplate("store-cities-list-template")).done(function(){var e=$.cookie("city")?$.cookie("city"):"Санкт-Петербург";storeCurrentCityName=e,$.getJSON(dataRawPath,function(t){var o={currentCityValues:{cityName:$.cookie("city")?$.cookie("city"):"Санкт-Петербург"},citiesList:[],citiesListAdvanced:[]},s=[],i=[];t.forEach(function(t,i,a){t.CITY==e&&s.push(t),-1===o.citiesList.indexOf(t.CITY)&&(o.citiesList.push(t.CITY),o.citiesListAdvanced.push({cityName:t.CITY,cityStoresCount:1}))}),$("#store-item-list").html($.templates["store-item-template"].render(t)),$("#store-about-count").html(s.length),$(".store-about__title").find("a").html(e),$(".store-about__sub-title").find("a").html(e),$(".store-about__sub-title").find("a").html($("#store-list-combobox option:selected").attr("value")),$(document).on("change","#store-list-combobox",function(){var e=$(this).find(":checked").val();$(".store-about__sub-title").find("a").html(e),$(".store-about__title").find("a").html(e),$("#store-about-count").html(s.length)}),$("#store-list-combobox").html($.templates["store-list-template"].render(i)),$(".store-list").html($.templates["store-cities-list-template"].render(o)),ymaps.ready(storeMapInit(t)),$(document).on("click",".store-item__button--gps",function(e){$(this).closest(".store-item").find(".store-item__gps-clipboard")[0].select();try{var t=document.execCommand("copy"),o=t?"successful":"unsuccessful";console.log("Cutting text command was "+o)}catch(e){console.log("Oops, unable to cut")}})})});