# _23001. Интегрировать в битрикс верстку раздела "Страница магазина" с использованием библиотеки jsrender

## 1. Описание к задаче

###### Для локальной копии:

 - обновить development\js\data\shops.json , актуальные данные взять отсюда https://zoloto585.ru/bitrix/templates/zoloto/components/bitrix/catalog.store.list/custom/json.php
 - настроить сборку development\htmls\shop-page.tmpl
 - раздел "СПИСОК МАГАЗИНОВ"(https://zoloto585.ru/about/address/): сделать кнопку "СТРАНИЦА МАГАЗИНА" на сплывающем окне над картой работающей, тюею она видима и при клике по ней происходит переход на страницу магазина


###### В backend-репозитории на гитлабе
 - создать раздел для страницы магазина на основе битрикс
 - подключить к нему необходимые скрипты для шаблонизации страницы

###### В frontend-репозитории на гитлабе:
 - добавить необходимые скрипты для шаблонизации страницы
 - замнеить стили

###### Протестировать

###### Заполнить анкету _23001.md





## 2. Описание работ:

#### 2.1 Работы связанные js-архитектурой
###### Сделал подключение js-приложения из папки frontend-репозитория
1). В файле /bitrix/templates/zoloto/header.php добавил подключил скрипт приложение(app.min.js) сразу после библиотеки libs.min.js:
```
<script src="<?= SITE_TEMPLATE_PATH ?>/frontend/js/app.min.js"></script>
```

2). Скрипты приложения находятся в папке development/js/app, собираются  "gulp js:app" в файл app.min.js , лист сборки хранится в переменной srcList.js.app

3). На frontend-репозиторий app.min.js копируется в папку /bitrix/templates/zoloto/frontend/js/

4). Файл предназначен для коллекции методов и свойств, на сонове которых будет более удобно работать с сайтом(как js-приложением)

5). Удалил папку /bitrix/templates/zoloto/js/views со всем содержимым, она переедет на /bitrix/templates/zoloto/frontend/js/views



#### 2.2 Работы связанные со страницей "АДРЕСА МАГАЗИНОВ"(zoloto585.ru/about/address/)
###### Сделал подключение js-скрипта отрисовки страницы из папки frontend-репозитория
1). В файле /bitrix/templates/zoloto/components/bitrix/catalog.store.list/custom/template.php 
строку
```
$this->addExternalJS("/bitrix/templates/zoloto/js/render/store.js");
```
заменил на
```
$this->addExternalJS("/bitrix/templates/zoloto/frontend/js/stores-page.min.js");

```
2). Удалил с backend-репозитория папку /bitrix/templates/zoloto/js/render со всем её содержимым

3). В папку /bitrix/templates/zoloto/frontend/js/ залил файл отрисовки страницы stores-page.min.js

4). Сделал видимой кнопку "СТРАНИЦА МАГАЗИНА" для попапов над картой




#### 2.3 Работы связанные со страницей "СТРАНИЦА МАГАЗИНА"(zoloto585.ru/about/address/адрес/магазина)

#### 2.4 Работы связанные с gulp-автоматизацией:
###### Добавил таски
js:app - собирает js-приложение
js:shop-page - собирает скрипты для страницы "СТРАНИЦА МАГАЗИНА"
js:stores-page - собирает скрипты для страницы "АДРЕСА МАГАЗИНОВ"

###### 
###### 
###### 

#### 2.5 Работы связанные с файлами сборки для github'а:
###### Для страницы "СТРАНИЦА МАГАЗИНА" убрал лишние html-файлы, добавил js-шаблон













## 3. Тестирование
###### "СТРАНИЦА МАГАЗИНА"
работает только локально
На DEV не получилось настроить url-маршрутизацию

###### "АДРЕСА МАГАЗИНОВ"
проаерил на DEV с текущими js-изменениями, работает



## 4. Комментарии разработчика
###### (ВАЖНО) в app.min.js задал определение среды запуска: локально, дев или прод
